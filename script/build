#!/bin/bash

set -euo pipefail
IFS=$'\n\t'
cd "$(cd "$(dirname "${0}")"; pwd)/../"

sync
sleep 1

docker run \
    --volume="$(pwd):/home/code" \
    --interactive --tty \
    develhack:latest \
    sh -c "\
    test -d build || ( mkdir -p build && cd build && cmake .. ) \
        && cd build \
        && make -j\$(getconf _NPROCESSORS_ONLN)"
